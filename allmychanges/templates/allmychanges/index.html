{% extends "allmychanges/base.html" %}


{% block extra_head %}
<script type="text/javascript">
    function MainCtrl($scope) {
        $scope.current_repo = {
            versions: [
                {
                    'name': '0.1.3',
                    'date': '2013-09-15',
                    'items': [
                        {
                            'text': "Backbone now has Controllers and History, for doing client-side routing based on URL fragments. Added emulateHTTP to provide support for legacy servers that dont do PUT and DELETE. Added emulateJSON for servers that can't accept application/json encoded requests. Added Model#clear, which removes all attributes from a model. All Backbone classes may now be seamlessly inherited by CoffeeScript classes.",
                            'changes': [
                                {
                                    'type': 'new',
                                    'text': 'IOS support'
                                },
                                {
                                    'type': 'fix',
                                    'text': 'Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. '
                                }
                            ]
                        },
                        {
                            'text': "Instead of requiring server responses to be namespaced under a model key, now you can define your own parse method to convert responses into attributes for Models and Collections. The old handleEvents function is now named delegateEvents, and is automatically called as part of the View's constructor. Added a toJSON function to Collections. Added Underscore's chain to Collections.",
                            'changes': [
                                {
                                    'type': 'new',
                                    'text': 'IOS support'
                                },
                                {
                                    'type': 'fix',
                                    'text': 'Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. '
                                }
                            ]
                        },
                        {
                            'text': null,
                            'changes': [
                                {
                                    'type': 'new',
                                    'text': 'IOS support'
                                },
                                {
                                    'type': 'fix',
                                    'text': 'Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. Android support. '
                                }
                            ]
                        }
                    ]
                }
            ]
        };
        $scope.current_repo.versions[1] = $scope.current_repo.versions[0];

        $scope.examples = [
            {
                'title': 'Flask',
                'url': 'https://github.com/mitsuhiko/flask/'
            },
            {
                'title': 'Django Rest Framework',
                'url': 'https://github.com/tomchristie/django-rest-framework/'
            },
            {
                'title': 'Gevent',
                'url': 'https://github.com/surfly/gevent/'
            }
        ]

        $scope.set_repo_and_submit = function(title, url) {
            $scope.current_repo.title = title;
            $scope.current_repo.url = url;
        };

        $scope.set_repo_and_submit($scope.examples[0].title, $scope.examples[0].url);  // for testing
    }
</script>
{% endblock extra_head %}


{% block content %}
    {% verbatim %}
    <div class="container" ng-controller="MainCtrl">
        <div class="headline">
            <form action="">
                <div class="input-group">
                    <input type="text" value="" placeholder="git repo url" class="form-control" ng-model="current_repo.url">
                    <span class="input-group-btn">
                        <input type="submit"
                               value="Show changelog"
                               class="btn btn-primary input-group-addon"
                               style="width: 9em; border-radius: 0px 5px 5px 0px;"/>
                    </span>
                </div>
            </form>

            <div style="text-align: right">
                Examples:
                <small ng-repeat="example in examples">
                    <a href="javascript: false"
                       style="border-bottom: 1px dotted"
                       ng-click="set_repo_and_submit(example.title, example.url)">
                        {{ example.title }}
                    </a>
                    <span ng-hide="$last">, </span>
                </small>
            </div>
        </div>

        <div>
            <h6 style="margin-bottom: 1.5em;"><a href="{{ current_repo.url }}">{{ current_repo.title }}</a></h6>
            <div>
                <div ng-repeat="version in current_repo.versions" class="change_container">
                    <div style="margin-bottom: 1em">
                        <span style="font-weight: bold; font-size: 1.3em; ">Version {{ version.name }}</span>
                        <span ng-show="version.date"
                              class="note"
                              style="font-size: 13px;">
                            &nbsp;{{ version.date }}
                        </span>
                    </div>
                    <ul class="list-unstyled">
                        <li ng-repeat="item in version.items">
                            <span ng-show="!$first">&nbsp;</span>
                            <p ng-show="item.text">{{ item.text }}</p>
                            <div class="row" ng-repeat="change in item.changes" style="padding-bottom: 0.5em;">
                                <div class="col-md-1">
                                    <div class="label"
                                          ng-class="{
                                              'label-info': change.type == 'new',
                                              'label-success': change.type == 'fix'
                                          }"
                                          style="width: 100%; display: block">
                                        <b>{{ change.type | uppercase }}</b>
                                    </div>
                                </div>
                                <div class="col-md-11" style="padding-left: 0px; padding-top: 0.1em;">
                                    {{ change.text }}
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    {% endverbatim %}
{% endblock content %}
