{% extends "allmychanges/base.html" %}


{% block extra_head %}
<script type="text/javascript">
    function MainCtrl($scope) {
        $scope.current_repo = {
            changelog: [
                {
                    'version': '0.1.3',
                    'date': '2013-09-15',
                    'items': [
                        {
                            'title': 'Support for fallback languages. Allows fine grained configuration through project settings and TranslationOptions on model basis. (thanks to Jacek Tomaszewski, resolves issue #104)',
                            'type': 'fix'
                        },
                        {
                            'title': 'Ядро 2',
                            'type': 'new'
                        }
                    ]
                },
                {
                    'version': '0.1.0',
                    'date': '2013-01-15',
                    'items': [
                        {
                            'title': 'Ядро 1',
                            'type': 'fix'
                        },
                        {
                            'title': 'Ядро 2',
                            'type': 'new'
                        },
                        {
                            'title': 'sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec ullamcorper nulla non metus auctor fringilla. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit.',
                            'type': 'new'
                        }
                    ]
                },
                {
                    'version': '0.0.1',
                    'items': [
                        {
                            'title': 'Ядро 1',
                            'type': 'fix'
                        },
                        {
                            'title': 'Ядро 2',
                            'type': 'new'
                        },
                        {
                            'title': 'sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec ullamcorper nulla non metus auctor fringilla. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit.',
                            'type': 'new'
                        }
                    ]
                }
            ]
        };

        $scope.examples = [
            {
                'title': 'Flask',
                'url': 'https://github.com/mitsuhiko/flask/'
            },
            {
                'title': 'Django Rest Framework',
                'url': 'https://github.com/tomchristie/django-rest-framework/'
            },
            {
                'title': 'Gevent',
                'url': 'https://github.com/surfly/gevent/'
            }
        ]

        $scope.set_repo_and_submit = function(title, url) {
            $scope.current_repo.title = title;
            $scope.current_repo.url = url;
        };

        $scope.set_repo_and_submit($scope.examples[0].title, $scope.examples[0].url);  // for testing
    }
</script>
{% endblock extra_head %}


{% block content %}
    {% verbatim %}
    <div class="container" ng-controller="MainCtrl">
        <div class="headline">
            <form action="">
                <div class="input-group">
                    <input type="text" value="" placeholder="git repo url" class="form-control" ng-model="current_repo.url">
                    <span class="input-group-btn">
                        <input type="submit"
                               value="Show changelog"
                               class="btn btn-primary input-group-addon"
                               style="width: 9em; border-radius: 0px 5px 5px 0px;"/>
                    </span>
                </div>
            </form>

            <div style="text-align: right">
                Examples:
                <small ng-repeat="example in examples">
                    <a href="javascript: false"
                       style="border-bottom: 1px dotted"
                       ng-click="set_repo_and_submit(example.title, example.url)">
                        {{ example.title }}
                    </a>
                    <span ng-hide="$last">, </span>
                </small>
            </div>
        </div>

        <div>
            <h6 style="margin-bottom: 1.5em;"><a href="{{ current_repo.url }}">{{ current_repo.title }}</a></h6>
            <div>
                <div ng-repeat="change in current_repo.changelog" class="change_container">
                    <div style="margin-bottom: 1em">
                        <span style="font-weight: bold; font-size: 1.3em; ">Version {{ change.version }}</span>
                        <span ng-show="change.date"
                              class="note"
                              style="font-size: 13px;">
                            &nbsp;{{ change.date }}
                        </span>
                    </div>
                    <ul class="list-unstyled">
                        <li ng-repeat="item in change.items" style="padding: 0.5em 0;">
                            <div class="row">
                                <div class="col-md-1">
                                    <div class="label"
                                          ng-class="{
                                              'label-info': item.type == 'new',
                                              'label-success': item.type == 'fix'
                                          }"
                                          style="width: 100%; display: block">
                                        {{ item.type | uppercase }}
                                    </div>
                                </div>
                                <div class="col-md-11" style="padding-left: 0px; padding-top: 0.1em;">
                                    {{ item.title }}
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    {% endverbatim %}
{% endblock content %}
